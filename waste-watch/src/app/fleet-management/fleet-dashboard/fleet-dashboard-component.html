<div class="dashboard-container">
  <!-- Sidebar Navigation -->
  <app-side-nav></app-side-nav>

  <!-- Main Content Area -->
  <div class="main-content">
    <!-- Header Section -->
    <header class="dashboard-header">
      <h1 class="dashboard-title">
        <fa-icon [icon]="faTruck"></fa-icon>
        Fleet Management Dashboard
      </h1>
      <button class="btn refresh-btn" (click)="refreshData()">
        <fa-icon [icon]="faSync"></fa-icon>
        Refresh Data
      </button>
    </header>

    <!-- Key Metrics Section -->
    <section class="stats-section">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-header">
            <fa-icon [icon]="faTruck"></fa-icon>
            <h3>Active Trucks</h3>
          </div>
          <div class="stat-value">{{ activeTrucks }}</div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <fa-icon [icon]="faGasPump"></fa-icon>
            <h3>Fuel Efficiency</h3>
          </div>
          <div class="stat-value">{{ fuelEfficiency }} km/L</div>
        </div>

        <!-- Modified card to show Avg CO2 Emissions -->
        <div class="stat-card">
          <div class="stat-header">
            <fa-icon [icon]="faExclamationTriangle"></fa-icon>
            <h3>Avg CO2 Emissions</h3>
          </div>
          <div class="stat-value">{{ avgCO2Emissions }} g/km</div> <!-- Display average CO2 emissions -->
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <fa-icon [icon]="faTools"></fa-icon>
            <h3>Total Collections</h3>
          </div>
          <div class="stat-value">{{ totalCollections }}</div>
        </div>
      </div>
    </section>

    <!-- Collections Overview -->
    <section class="collections-section">
      <header class="collections-header">
        <h3>Today's Collections</h3>
        <div class="collections-stats">
          <span class="collections-value">{{ todayCollections }}</span>  <!-- Display the daily collections -->
          <span class="collections-trend" [class.positive]="collectionTrend > 0">
            {{ collectionTrend }}%
            <fa-icon [icon]="faChartLine"></fa-icon>
          </span>
          <span class="collections-comparison">vs. previous day</span>
        </div>
      </header>

      <!-- Charts Grid -->
      <div class="chart-grid">
        <!-- Collection Breakdown (Pie Chart) -->
        <div class="chart-container">
          <h4>Collection Breakdown</h4>
          <canvas #pieChart></canvas>
        </div>
      </div>
    </section>


    <!-- Alerts Section -->
    <section class="alerts-section">
      <h3>Active Alerts</h3>
      <div class="alerts-container">
        <div
          *ngFor="let alert of activeAlerts"
          class="alert-card"
          [class.critical]="alert.type === 'Critical'"
          [class.warning]="alert.type === 'Warning'"
        >
          <fa-icon [icon]="faExclamationTriangle"></fa-icon>
          <div class="alert-content">
            <h4>{{ alert.message }}</h4>
            <p>{{ alert.details }}</p>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
